<template>
  <div v-bind="getRootProps()" class="container-upload cursor-pointer">
    <input v-bind="getInputProps()" />

    <div v-if="!file" class="flex flex-col items-center gap-3">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="79"
        height="76"
        viewBox="0 0 79 76"
        fill="none"
      >
        <rect
          x="16.4868"
          y="15.804"
          width="62.5133"
          height="59.923"
          rx="15"
          fill="#F1EEFF"
        />
        <rect
          x="11.4917"
          y="11.6943"
          width="61.5133"
          height="58.923"
          rx="14.5"
          fill="white"
          stroke="black"
        />
        <path
          d="M47.5201 27.8574H32.3351C31.7045 27.8574 31.1748 28.3652 31.1748 28.9697V53.3422C31.1748 53.9467 31.7045 54.4544 32.3351 54.4544H52.1362C52.7668 54.4544 53.2965 53.9467 53.2965 53.3422V33.3944L47.5201 27.8574V32.2822C47.5201 32.8867 48.0499 33.3944 48.6805 33.3944H53.2965"
          fill="white"
        />
        <path
          d="M48.6807 35.6189C46.7636 35.6189 45.1997 34.1198 45.1997 32.2822V27.8574H47.5203L53.2967 33.3944V35.6189H48.6807Z"
          fill="#C4B7FF"
        />
        <path
          d="M52.1613 55.1799H32.335C31.2756 55.1799 30.418 54.3578 30.418 53.3423V28.9698C30.418 27.9543 31.2756 27.1322 32.335 27.1322H45.1994C45.6282 27.1322 45.9561 27.4465 45.9561 27.8576C45.9561 28.2686 45.6282 28.5829 45.1994 28.5829H32.335C32.108 28.5829 31.9314 28.7522 31.9314 28.9698V53.3423C31.9314 53.5599 32.108 53.7292 32.335 53.7292H52.1361C52.3631 53.7292 52.5397 53.5599 52.5397 53.3423V34.12H48.6804C47.6209 34.12 46.7633 33.2979 46.7633 32.2823V27.8576C46.7633 27.5674 46.9399 27.3014 47.2426 27.1806C47.52 27.0597 47.848 27.1322 48.075 27.3498L53.8513 32.8868L53.8766 32.911C54.0027 33.0319 54.0784 33.2011 54.0784 33.3946V53.3423C54.0784 54.3578 53.1955 55.1799 52.1613 55.1799ZM48.2768 29.5985V32.2823C48.2768 32.5 48.4533 32.6692 48.6804 32.6692H51.4802L48.2768 29.5985Z"
          fill="black"
        />
        <path
          d="M47.5706 48.5306H36.4467C36.0179 48.5306 35.6899 48.2163 35.6899 47.8052C35.6899 47.3942 36.0179 47.0798 36.4467 47.0798H47.5706C47.9994 47.0798 48.3273 47.3942 48.3273 47.8052C48.3273 48.2163 47.9994 48.5306 47.5706 48.5306Z"
          fill="black"
        />
        <path
          d="M47.5706 44.106H36.4467C36.0179 44.106 35.6899 43.7917 35.6899 43.3806C35.6899 42.9696 36.0179 42.6553 36.4467 42.6553H47.5706C47.9994 42.6553 48.3273 42.9696 48.3273 43.3806C48.3273 43.7917 47.9994 44.106 47.5706 44.106Z"
          fill="black"
        />
        <path
          d="M47.5706 39.657H36.4467C36.0179 39.657 35.6899 39.3427 35.6899 38.9317C35.6899 38.5206 36.0179 38.2063 36.4467 38.2063H47.5706C47.9994 38.2063 48.3273 38.5206 48.3273 38.9317C48.3273 39.3427 47.9994 39.657 47.5706 39.657Z"
          fill="black"
        />
        <ellipse
          cx="16.487"
          cy="15.8039"
          rx="16.487"
          ry="15.8039"
          fill="white"
        />
        <path
          d="M18.1558 3.39404C19.2866 3.53243 20.3719 3.81009 21.3931 4.20752L21.2124 4.67334C22.2259 5.06782 23.1737 5.58455 24.0347 6.20557L24.3257 5.80029C25.2368 6.45739 26.0527 7.22811 26.7563 8.0874L26.3726 8.40283C27.0512 9.2317 27.6183 10.1476 28.0522 11.1294L28.5093 10.9272V10.9263C28.9552 11.9351 29.2661 13.0116 29.4224 14.1353H29.4233L28.9282 14.2036C29.001 14.7268 29.0386 15.2615 29.0386 15.8042C29.0386 16.3468 29.001 16.8807 28.9282 17.4038L29.4224 17.4722C29.2662 18.5958 28.9552 19.6724 28.5093 20.6812L28.0522 20.479C27.6183 21.4608 27.0512 22.3767 26.3726 23.2056L26.7563 23.519C26.0527 24.3785 25.2368 25.149 24.3257 25.8062L24.0347 25.4019C23.1737 26.0229 22.2259 26.5406 21.2124 26.9351L21.3931 27.3999C20.3719 27.7973 19.2865 28.074 18.1558 28.2124L18.0962 27.7173C17.5694 27.7818 17.0314 27.8149 16.4858 27.8149C15.9405 27.8149 15.4031 27.7818 14.8765 27.7173L14.8159 28.2124C13.6852 28.0739 12.5998 27.7974 11.5786 27.3999L11.7603 26.9351C10.7468 26.5406 9.79894 26.0229 8.93799 25.4019L8.646 25.8062C7.73494 25.1489 6.9189 24.3784 6.21533 23.519L6.6001 23.2056C5.92145 22.3767 5.35438 21.4608 4.92041 20.479L4.46338 20.6812H4.4624C4.01653 19.6724 3.7055 18.5957 3.54932 17.4722L4.04443 17.4038C3.98988 17.0115 3.9549 16.6131 3.94092 16.2095L3.93408 15.8042C3.93408 15.2615 3.97168 14.7268 4.04443 14.2036L3.54932 14.1353C3.70553 13.0117 4.01651 11.935 4.4624 10.9263L4.46338 10.9272L4.92041 11.1294C5.35437 10.1476 5.92144 9.23171 6.6001 8.40283L6.21533 8.0874C6.91891 7.22812 7.73497 6.45741 8.646 5.80029L8.93799 6.20557C9.79892 5.58456 10.7468 5.06782 11.7603 4.67334L11.5786 4.20752C12.5998 3.81003 13.6852 3.53251 14.8159 3.39404L14.8765 3.89014C15.4031 3.82566 15.9405 3.7925 16.4858 3.79248C17.0314 3.79248 17.5694 3.82564 18.0962 3.89014L18.1558 3.39404Z"
          fill="white"
          stroke="#C4B7FF"
          stroke-dasharray="3 3"
        />
        <path
          d="M19.8415 15.2895H17.0239V12.5887C17.0239 12.3057 16.7824 12.0742 16.4872 12.0742C16.192 12.0742 15.9505 12.3057 15.9505 12.5887V15.2895H13.1329C12.8377 15.2895 12.5962 15.521 12.5962 15.804C12.5962 16.0869 12.8377 16.3184 13.1329 16.3184H15.9505V19.0193C15.9505 19.3022 16.192 19.5337 16.4872 19.5337C16.7824 19.5337 17.0239 19.3022 17.0239 19.0193V16.3184H19.8415C20.1366 16.3184 20.3782 16.0869 20.3782 15.804C20.3782 15.521 20.1366 15.2895 19.8415 15.2895Z"
          fill="#C4B7FF"
        />
      </svg>
      <p>Drop your files to upload</p>
      <span
        class="border py-2 px-4 text-xs rounded-2xl cursor-pointer"
        :style="{ borderColor: '#C4C4C4' }"
        >Select files</span
      >
    </div>

    <div v-if="file" class="h-full relative">
      <img v-if="file.preview" :src="file.preview" />
      <i
        class="absolute top-2 right-2"
        @click="
          (e) => {
            e.stopPropagation();
            removeFile();
          }
        "
      >
        <svg
          class="w-6 h-6 text-white dark:text-black"
          aria-hidden="true"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          fill="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            fill-rule="evenodd"
            d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm7.707-3.707a1 1 0 0 0-1.414 1.414L10.586 12l-2.293 2.293a1 1 0 1 0 1.414 1.414L12 13.414l2.293 2.293a1 1 0 0 0 1.414-1.414L13.414 12l2.293-2.293a1 1 0 0 0-1.414-1.414L12 10.586 9.707 8.293Z"
            clip-rule="evenodd"
          />
        </svg>
      </i>
    </div>

    <!-- <ul class="mt-4 text-left">
      <li v-for="file in myFiles" :key="file.name">
        {{ file.name }} - {{ (file.size / 1024).toFixed(1) }} KB
      </li>
    </ul> -->
  </div>
</template>

<script setup>
import { useDropzone } from 'vue3-dropzone';
import { ref, onUnmounted } from 'vue';

const file = ref(null);

const { getRootProps, getInputProps } = useDropzone({
  accept: 'image/*',
  multiple: false,
  onDrop(acceptedFiles) {
    // myFiles.value = acceptedFiles;
    if (acceptedFiles.length > 0) {
      const f = acceptedFiles[0];
      file.value = Object.assign(f, {
        preview: URL.createObjectURL(f),
      });
    }
  },
});

const removeFile = () => {
  if (file.value?.preview) URL.revokeObjectURL(file.value.preview);
  file.value = null;
};

onUnmounted(() => {
  if (file.value?.preview) URL.revokeObjectURL(file.value.preview);
});
</script>

<style scoped>
.container-upload {
  border-radius: 15px;
  border: 2px dashed #8e8e8e;
  padding: 14px;
  height: 200px;
}

.container-upload img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}
</style>
